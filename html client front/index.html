<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>cO-Op | blockchain </title>
    <link rel="shortcut icon" href="TemplateData/favicon.ico">
    <link rel="stylesheet" href="TemplateData/style.css">
    <script src="TemplateData/UnityProgress.js"></script>
    <script src="Build/UnityLoader.js"></script>

    <script>
        var unityInstance = UnityLoader.instantiate("unityContainer", "Build/7.json", { onProgress: UnityProgress });
    </script>

    <!--not getting used
    <script>

        /*****************************************/
        /* Detect the MetaMask Ethereum provider */
        /*****************************************/

        import detectEthereumProvider from '@metamask/detect-provider';

        // this returns the provider, or null if it wasn't detected
        const provider = await detectEthereumProvider();

        if (provider) {
            startApp(provider); // Initialize your app
        } else {
            console.log('Please install MetaMask!');
        }

        function startApp(provider) {
            // If the provider returned by detectEthereumProvider is not the same as
            // window.ethereum, something is overwriting it, perhaps another wallet.
            if (provider !== window.ethereum) {
                console.error('Do you have multiple wallets installed?');
            }
            // Access the decentralized web!
        }

        /**********************************************************/
        /* Handle chain (network) and chainChanged (per EIP-1193) */
        /**********************************************************/

        // Normally, we would recommend the 'eth_chainId' RPC method, but it currently
        // returns incorrectly formatted chain ID values.
        let currentChainId = ethereum.chainId;

        ethereum.on('chainChanged', handleChainChanged);

        function handleChainChanged(_chainId) {
            // We recommend reloading the page, unless you must do otherwise
            window.location.reload();
        }

        /***********************************************************/
        /* Handle user accounts and accountsChanged (per EIP-1193) */
        /***********************************************************/

        let currentAccount = null;
        ethereum
            .request({ method: 'eth_accounts' })
            .then(handleAccountsChanged)
            .catch((err) => {
                // Some unexpected error.
                // For backwards compatibility reasons, if no accounts are available,
                // eth_accounts will return an empty array.
                console.error(err);
            });

        // Note that this event is emitted on page load.
        // If the array of accounts is non-empty, you're already
        // connected.
        ethereum.on('accountsChanged', handleAccountsChanged);

        // For now, 'eth_accounts' will continue to always return an array
        function handleAccountsChanged(accounts) {
            if (accounts.length === 0) {
                // MetaMask is locked or the user has not connected any accounts
                console.log('Please connect to MetaMask.');
            } else if (accounts[0] !== currentAccount) {
                currentAccount = accounts[0];
                // Do any other work!
            }
        }

        /*********************************************/
        /* Access the user's accounts (per EIP-1102) */
        /*********************************************/

        // You should only attempt to request the user's accounts in response to user
        // interaction, such as a button click.
        // Otherwise, you popup-spam the user like it's 1999.
        // If you fail to retrieve the user's account(s), you should encourage the user
        // to initiate the attempt.
        document.getElementById('connectButton', connect);

        function connect() {
            ethereum
                .request({ method: 'eth_requestAccounts' })
                .then(handleAccountsChanged)
                .catch((err) => {
                    if (err.code === 4001) {
                        // EIP-1193 userRejectedRequest error
                        // If this happens, the user rejected the connection request.
                        console.log('Please connect to MetaMask.');
                    } else {
                        console.error(err);
                    }
                });
        }
    </script>

    not getting used-->

    <div class="header">
        <a href="#default" class="logo">cO-Op</a>
        <div class="header-right">


        </div>
    </div>


</head>
<body style="background-color: black;>
   




    <nav class="navbar navbar-default navbar-static-top">
        <div class="container-fluid">
            <div class="navbar-header">
                <a class="navbar-brand" href="#">
                    Logo
                </a>
            </div>
        </div>
    </nav>
    <main class="container">
        <div class="row">
            <div class="content">
                <p>
                    <div class="webgl-content">
                        <!-- <div id="unityContainer" style="width: 960px; height: 600px"></div> -->

                        <div id="unityContainer"></div>

                        <div class="footer">
                            <div class="webgl-logo"></div>
                            <div class="fullscreen" onclick="unityInstance.SetFullscreen(1)"></div>
                            <div class="title">co-op</div>
                        </div>
                    </div>
                </p>
            </div>
            <div class="sidebar text-center">


                <a class="ConnectButton">
                    <!-- MetamaskButton/webglhtmlfront -->
                    <button class="enableEthereumButton" onclick="getAccount();">Enable Ethereum; Connect(); </button>
                </a>

                <div class="accountconnected"><p class="account"> Account: <div id="add">"not connected"</div></p></div>

                <div class="sidebartext">
                    ----------------<br />
                    RINKEBY TESTNET ONLY<br />
                    ----------------<br />
                    <br />

                    Enable Ability by Sending Funds to Server Pool
                    Address between Que.
                    <p>

                        Server pool account address:
                        <br /><br />
                        <b>co-op.eth</b>
                        <br /><br />
                        0xc3534C6A6F85661c88c
                        9551255FAE479bd50B877<br /><br />
                        -winner takes all.<br /><br />
                        --------------------<br />
                    </p>
                    <p>
                        Server IP: 35.193.205.116
                    </p>
                    --------------------<br />
                    <br />
                    cO-Op:game:
                    Multiplayer blockchain based verse.<br />
                    <br />
                    Ethonline Hackathon Proto
                    <br />
                    -------------------<br />
                    <br />
                    <!-- Add icon library -->
                    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fork-awesome@1.1.7/css/fork-awesome.min.css" integrity="sha256-gsmEoJAws/Kd3CjuOQzLie5Q3yshhvmo7YNtBG7aaEY=" crossorigin="anonymous">
                    <!-- Add font awesome icons -->

                    <a href=" https://medium.com/co-op" target="_blank" class="fa fa-medium"></a>
                    <a href=" https://discord.gg/hZttUdB" target="_blank" <i class='fa fa-discord'></i></a>
                    <a href="https://github.com/co-op-game" target="_blank" class="fa fa-github"></a>
                    <a href="https://twitter.com/cO_Op_game" target="_blank" class="fa fa-twitter"></a><br />



                </div>


                </div>
            </div>
        </main>






        <!--  Unity sends debug
        <div>
            <input placeholder="Enter text..." id="htmlinput"><button onclick="sendBackMessage()">Send to Unity</button>
        </div>
        <div style="border:solid 1px black; width:200px; height:30px; text-align:center" onclick="ConnectToGame();">RED </div>

        <!-------------->


                        <script>

                            //for debug >>>>>>>>>>>
                            function sendBackMessage() {
                                var message = document.getElementById("htmlinput").value;
                                console.log("Sending message to Unity: " + message);
                                unityInstance.SendMessage("Local", "WebHookSpawn", message);
                            }
                            // <<<<<<<<<

                            async function getAccount() {
                                // connecting metamask
                                const accounts = await ethereum.request({ method: 'eth_requestAccounts' });
                                const account = accounts[0];
                                var showAccount = document.getElementById("add");
                                showAccount.innerHTML = account;
                                //  const account = "debugger";
                                ConnectToGame(account);
                            }


                            function ConnectToGame(account) {

                                getaddress(account);

                            }

                            function getaddress(account) {

                                // Unity sends
                                unityInstance.SendMessage('Local', 'WebHookSpawn', account);

                            }


                        </script>


</body>
</html>
